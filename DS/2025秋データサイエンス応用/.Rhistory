demo()
demo()
1+2
3*9
5／2
5/2
1/0
1 + 1
x <- 2
x
y <- x+2
y\
y
あ <- 1
あ
sqrt(2)
5+
3
5-
c
rep(c(1,2,3), 3)
rep((c(1,2,3)), 3)
getwd()
install.packages(tidyverse)
install.packages('tidyverse')
install.packages('ragg')
install.packages('textshaping')
install.packages('textshaping')
install.packages('ragg')
install.packages('ragg')
install.packages('tidyverse')
exp(1)
exp(4)
log(54.59815)
log(100)
log10(100)
log2(100)
round(pi, 2)
floor(pi)
help('round')
library(tidyverse)
seq(10)
seq(5,10)
seq(5, 10)
seq(3, 10, 2)
vec1 = seq(10,50,10)
vec2 = seq(50,10,10)
vec2 = seq(50,10,-10)
vec1;vec2
result1 <- vec1 > vec2
print(result1)
result2 <- vec1 == vec2
print(result2)
result3 <- (vec1 > 30) | (vec2 >30); print(result3)
vec1
vec1[3]
greater_than_30 <- vec1[vec1 > 30]
print(greater_than_30)
result5 <- vec1[vec1 %% 4 == 0]
print(result5)
0/10
0/01
0/0
0/0
0/00
result4 <- (vec1 >= 30 ) & (vec2 >= 30)
print(result4)
getwd()
ls
ls()
getwd()
cd ..
getwd()
ls()
ls.files()
head(example_3_1.csv)
employee <- read.csv("example_3_1.csv")
head(employee)
mean(employee$Age)
mean(employee$Salary)
median(employee$Salary)
x <- c(300,400,400,450,550,600,1800)
y <-c(300,400,400 ,450, 550, 600, 650)
quantile(x)
range(x)
var(x)
sd(x)
install.packages(c("reticulate", "xml2"))
install.packages("psych")
summy(employee)
summary(employee)
describe(employee)
library(psych)
describe(example())
describe(employee)
nrow(employee)
rownames(employee)
length(rownames(employee))
head(employee)
aggregate(Salary ~ Gender, data = employee, mean)
aggregate(Salary ~ Gender, data = employee, summary())
aggregate(Salary ~ Gender, data = employee, summary)
student_scores <- read.csv("student_scores.csv")
head(student_scores)
mean(student_scores)
summary(student_scores)
aggregate(Gender ~ Math+English+Japanese, data = student_scores, mean)
aggregate(cbind(Math, English, Japanese) ~ Gender, data = student_scores, mean)
student_scores$Math_Group <- ifelse(student_scores$Math >= 50, "50 or more", "Below 50"
head(studen_scores$Math_Group)
head(student_scores)
student_scores$Math_Group
student_scores$Math_Group <- ifelse(student_scores$Math >= 50, "50 or more", "Below 50"
)
head(student_scores)
table(student_scores$Math_Group, student_scores$Gender)
prop.table(table(student_scores$Gender, student_scores$Math_Group))
cor(, c("Math", "English", "Japanese"))
cor(student_scores[, c("Math", "English", "Japanese")])
describe(student_scores)
prop.table(table(student_scores$Gender, student_scores$Math_Group), 1)
data(iris)
head(iris)
summary(iris)
hist(iris$Sepal.Length, main="がく片の長さの分布", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black")
ls
pwd
par(family = "Hiragino Sans")
plot(1:5, main = "日本語タイトル", family = "Hiragino Sans")
hist(iris$Sepal.Length, main="がく片の長さの分布", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black")
usethis::edit_r_profile()
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length,)
hist(iris$Sepal.Length)
hist(iris$Sepal.Width, main="がく片の幅の分布", xlab="がく片の幅", ylab="個体数", col = "lightblue", border = "black")
hist(iris$Sepal.Width, main="がく片の幅の分布", xlab="がく片の幅", ylab="個体数", col = "lightblue", border = "black", breaks = 10)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
quartz()
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black")
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
par(family = "Hiragino Sans")   # set Japanese font
hist(
iris$Sepal.Length,
main = "がく片の長さの分布（階級数20）",
xlab = "がく片の長さ",
ylab = "個体数",
col = "lightblue",
border = "black",
breaks = 20
)
par(family = "Hiragino Sans")   # set Japanese font
hist(
iris$Sepal.Length,
main = "がく片の長さの分布（階級数20）",
xlab = "がく片の長さ",
ylab = "個体数",
col = "lightblue",
border = "black",
breaks = 20
)
quartz()
par(family = "Hiragino Sans")
hist(
iris$Sepal.Length,
main = "がく片の長さの分布（階級数20),
xlab = "がく片の長さ",
par(family = "Hiragino Sans")   # set Japanese font
hist(
iris$Sepal.Length,
main = "がく片の長さの分布（階級数20）",
xlab = "がく片の長さ",
ylab = "個体数",
col = "lightblue",
border = "black",
breaks = 20
)
par(family = "Hiragino Sans")   # set Japanese font
hist(
iris$Sepal.Length,
main = "がく片の長さの分布（階級数20)",
xlab = "がく片の長さ",
ylab = "個体数",
col = "lightblue",
border = "black",
breaks = 20
)
1+log2(150)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4.0, 8.0, by = 1.0) )
install.packages("showtext")
library(showtext)
font_add_google("Noto Sans JP", "jp")
showtext_auto()
plot(1:10, main = "日本語タイトル", xlab = "横軸", ylab = "縦軸")
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4.0, 8.0, by = 1.0) )
install.packages("showtext")
library(showtext)
font_add_google("Noto Sans JP", "jp")
showtext_auto()
plot(1:10, main = "日本語タイトル", xlab = "横軸", ylab = "縦軸")
hist(iris$Sepal.Width, main="がく片の幅の分布", xlab="がく片の幅", ylab="個体数", col = "lightblue", border = "black")
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4.0, 8.0, by = 1.0) )
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4, 8, by = 1) )
font_add("Hiragino", "/System/Library/Fonts/ヒラギノ角ゴシック W3.ttc")
boxplot(iris$Sepal.Length, main = "がく片の長さの分布", ylab = "Sepal Length", col = "lightblue")
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4.0, 8.0, by = 1.0) )
boxplot(iris[, 1:4], main = "がく片と花弁の長さの分布", names = c("がく片の長さ", "がく片の幅", "花弁の長さ", "花弁の幅"), col = c("lightblue", "lightgreen", "lightpink", "lightyellow"))
boxplot(
iris[, 1:4],
main = "がく片と花弁の長さの分布",
names = c("がく片の長さ", "がく片の幅", "花弁の長さ", "花弁の幅"),
col = c("lightblue", "lightgreen", "lightpink", "lightyellow"),
las = 2      # rotate label to vertical
)
boxplot(
iris[, 1:4],
main = "がく片と花弁の長さの分布",
names = c("がく片の\n長さ", "がく片の\n幅", "花弁の\n長さ", "花弁の\n幅"),
col = c("lightblue", "lightgreen", "lightpink", "lightyellow")
)
boxplot(Sepal.Length ~ Species, data = iris, main = "種ごとのがく片の長さ分布の比較", xlab = "アヤメの種", ylab = "がく片の長さ", names = c("セトーサ", "バーシカラー", "バージニア") , col = c("lightblue", "lightgreen", "lightpink"))
boxplot(Petal.Length ~ Species, data = iris, main = "種ごとの花弁の長さ分布の比較", xlab = "アヤメの種", ylab = "花弁の長さ", names = c("セトーサ", "バーシカラー", "バージニア") , col = c("lightblue", "lightgreen", "lightpink"))
cor_matrix <- cor(iris[, 1:4])
print(cor_matrix)
plot(iris$Sepal.Length, iris$Petal.Length, main = "がく片の長さと花弁の長さの散布図",xlab = "がく片の長さ", ylab = "花弁の長さ", col = "blue", pch = 19)
pairs(iris[, 1:4], main = "Irisデータの散布図行列",col = iris$Species)
1+log2(600)
hist(iris$Sepal.Length, main="がく片の長さの分布", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black")
hist(iris$Sepal.Width, main="がく片の幅の分布", xlab="がく片の幅", ylab="個体数", col = "lightblue", border = "black")
hist(iris$Sepal.Length, main="がく片の長さの分布（階級数20）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = 20)
hist(iris$Sepal.Length, main="がく片の長さの分布（階級幅を1.0に指定）", xlab="がく片の長さ", ylab="個体数", col = "lightblue", border = "black", breaks = seq(4.0, 8.0, by = 1.0) )
data <- read.csv("5-4.csv")
ls
data <- read.csv("5-4.csv")
str(data)
data_lm <- lm(PersonHaishutsu~pAge15.64, data)
summary(data_lm)
data_lm2 <- lm(PersonHaishutsu~., data)
summary(data_lm2)
data_lm2 <- lm(PersonHaishutsu~., data)
summary(data_lm2)
round(cor(data$pPopRoudou,data$pAge15.64),4)
round(cor(data),3)
round(cor(data),3)
install.packages("car")
ERROR: dependency ‘nloptr’ is not available for package ‘lme4’
install.packages("nloptr")
install.packages("nloptr")
install.packages("lme4")
install.packages("pbkrtest")
install.packages("car")
vif(data_lm2)
library(car)
vif(data_lm2)
model_A <- lm(PersonHaishutsu~PopTotal+pPopForeign+pPopRoudou+PersonChihouzei+pKakukazoku+pKajyuuchi+pKeijyou+pP_IndustryWorker
,data)
AIC(model_A)
summary(model_A)
model_B <- lm(PersonHaishutsu~PopTotal+pPopForeign+pPopRoudou+pKakukazoku+pKeijyou,data)
AIC(model_B)
summary(model_B)
model_C <- lm(PersonHaishutsu ~ pAgeO75 + pKakukazoku + pAgeU15 + pPopRoudou + pMinsei,  data)
summary(model_C)
# AICの確認
AIC(model_C)
summary(model_C)
install.packages("tidyverse")
library(tidyverse)
data_scale <-
data %>%
scale(center = TRUE, scale = TRUE) %>%
as.data.frame()
model_C_scaled <- lm(PersonHaishutsu ~ pAgeO75 + pKakukazoku + pAgeU15 + pPopRoudou + pMinsei, data_scale)
summary(model_C_scaled)
data <- read.csv("5-4.csv")
str(data)
install.packages("glmnet")
install.packages("plotmo")
library(glmnet)
library(plotmo)
library(tidyverse)
x.Ridge <- data %>%
select(pAgeO75,pKakukazoku,pAgeU15,pPopRoudou,pMinsei) %>%
as.matrix()
x.Lasso <- data %>%
select(-PersonHaishutsu) %>%
as.matrix()
View(x.Lasso)
y <- data %>%
select(PersonHaishutsu) %>%
as.matrix()
View(y)
View(student_scores)
head(x.Ridge,3)
data_Ridge <- glmnet(x.Ridge,y,alpha = 0)
plot(data_Ridge)
plot_glmnet(data_Ridge,xvar="lambda",label=T)
set.seed(123) # 乱数のシード値を固定
data_Ridge_cv <- cv.glmnet(x.Ridge,y,alpha=0)
plot(data_Ridge_cv)
data_Ridge_cv$lambda.min
log(data_Ridge_cv$lambda.min)
coef(data_Ridge_cv, s="lambda.min")
data_Lasso <- glmnet(x.Lasso,y,alpha=1)
plot_glmnet(data_Lasso,xvar="lambda",label=T)
set.seed(123) # 乱数のシード値を固定
data_Lasso_cv <- cv.glmnet(x.Lasso,y,alpha=1)
plot(data_Lasso_cv)
data_Lasso_cv$lambda.1se
log(data_Lasso_cv$lambda.1se)
coef(data_Lasso_cv, s="lambda.1se")
data_lm6 <- lm(PersonHaishutsu~PersonSaishutsu+PersonDoboku+pAge15.64+pKajyuuchi,data=data)
summary(data_lm6)
data <- read.csv("data/7-4.csv")
str(data)
set.seed(123)
index_num <- sample(seq_len(nrow(data)), size = 0.7 * nrow(data))
train_data <- data[index_num, ]
test_data <- data[-index_num, ]
table(train_data$is_canceled)
data_logistic <- glm(is_canceled ~ ., data = train_data, family = binomial(link= "logit"))
summary(data_logistic)
summary(data_logistic)
family = binomial(link= "logit"))
family = binomial(link= "logit"))
)
data_logistic2 <- glm(
is_canceled ~ lead_time +
previous_cancellations +
previous_bookings_not_canceled +
adr +
total_of_special_requests +
meal_HB,
data = train_data,
family = binomial(link = "logit")
)
summary(data_logistic2)
AIC(data_logistic2)
library(glmnet)
library(tidyverse)
x_train <- train_data %>%
select(-is_canceled) %>%
as.matrix()
y_train <- train_data$is_canceled
set.seed(1234) #再現のため
data_lasso <- cv.glmnet(x_train, y_train, alpha = 1, family = "binomial")
coef(data_lasso,s="lambda.min")
predict_logstic <- predict(data_logistic2, newdata = test_data, type = "response")
predicted_class <- ifelse(predict_logstic > 0.5, 1, 0)
conf_matrix <- table(Predicted = predicted_class, Actual = test_data$is_canceled)
conf_matrix
(181+44)/(181+61+14+44)
# 最良のラムダ値でテストデータに対して予測
x_test <- test_data %>%
select(-is_canceled) %>%
as.matrix()
predict_lasso <- predict(data_lasso, s = data_lasso$lambda.min,
newx = x_test, type = "response")
predicted_class_lasso <- ifelse(predict_lasso > 0.5, 1, 0)
# 混同行列の作成と精度の計算
conf_matrix_lasso <- table(Predicted = predicted_class_lasso, Actual = test_data$is_canceled)
conf_matrix_lasso
(189+50)/(189+50+55+6)
0.4/0.6
